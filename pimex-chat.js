(()=>{const t="https://pimex-chat-api.herokuapp.com",e=document,a=window;let i={};a.ChatPimex={init:async function({id:a,token:o}){const n="Basic "+btoa(`${a}:${o}`);i=JSON.parse(localStorage.getItem("pimexChatData"))||await async function(e,a){const i=await fetch(`${t}/user`,{method:"GET",headers:{Authorization:e}}),o=await i.json(),n=await async function(){try{const t=await fetch("https://freegeoip.app/json/",{method:"GET"}),{city:e,country_name:a}=await t.json();return e||a}catch(t){return""}}(),s=await fetch(`${t}/chat`,{method:"POST",headers:{Authorization:e,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({boardId:a.id,location:n})}),c={id:(await s.json()).id,userId:o};return localStorage.setItem("pimexChatData",JSON.stringify(c)),c}(n,{id:a,token:o});const s=await async function(e,a){const i=await fetch(`${t}/chat/${a.id}/config`,{method:"GET",headers:{Authorization:e}});return await i.json()}(n,{id:a,token:o}),c=`button-pimex-${i.id}`,r=`chat-pimex-${i.id}`,l=`\n    #${r}{opacity:0;visibility:hidden;position:fixed;bottom:80px;right:0;z-index:9999;border:none;width:430px;height:calc(100vh - 140px);transform:translateY(25px);transition:opacity 0.2s ease-out,visibility 0.2s ease-out,transform 0.1s ease-out;}\n    #${r}.active{opacity:1;visibility:visible;transform:translateY(0);}\n    #${c}{background-color:${s.color};border-radius:50%;position:fixed;bottom:${s.margin.bottom}px;right:${s.margin.right}px;z-index:10000;width:60px;height:60px;padding:0;border:none;outline:none;transform:scale(0);opacity:0;transition: opacity 0.2s ease-out,transform 0.2s ease-out;}\n    #${c}.loaded{transform:scale(1);opacity:1;}\n    #${c}.active .open{opacity:0;transform:scale(0.1)rotate(90deg);}\n    #${c}.active .close{opacity:1;transform:scale(1)rotate(0);}\n    #${c} svg{position:absolute;top:0;left:0;width:100%;height:100%;}\n    #${c} .open{transition:transform 0.2s ease-out,opacity 0.2s ease-out;transform:scale(1) rotate(0);}\n    #${c} .close{transition: transform 0.2s ease-out, opacity 0.2s ease-out;opacity:0;transform:scale(0.1) rotate(-90deg);}\n    @media (max-width: 767.98px) { \n      #${r}{width:100vw;height:calc(100vh - 100px);right:0;left:0;}\n    }\n    `,d=e.createElement("style");d.styleSheet?d.styleSheet.cssText=l:d.appendChild(e.createTextNode(l)),e.getElementsByTagName("head")[0].appendChild(d);const p=e.createElement("iframe");p.id=r,p.src=`https://pimex-chat-widget.herokuapp.com/${i.userId}/${i.id}/${a}/${o}`;const h=e.createElement("button");h.id=c;const u=e.createElement("div"),m=e.createElementNS("http://www.w3.org/2000/svg","svg"),w=e.createElementNS("http://www.w3.org/2000/svg","path"),g=e.createElementNS("http://www.w3.org/2000/svg","path"),f=e.createElementNS("http://www.w3.org/2000/svg","svg"),y=e.createElementNS("http://www.w3.org/2000/svg","path");w.setAttributeNS(null,"fill","white"),w.setAttributeNS(null,"d","M125.19,84l.14.29c.11.25.22.49.29.62A54.07,54.07,0,0,0,149.72,110a20.18,20.18,0,0,1-9.34,2.38,3.12,3.12,0,0,0-2.51,1.24,2.84,2.84,0,0,0-.42,2.67,21.24,21.24,0,0,0,7.45,9.22c-1.92.37-3.83.84-5.7,1.39l28.64,25a2,2,0,0,0,3.32-1.5V111a27.6,27.6,0,0,0,25.41-27.53V27.6A27.6,27.6,0,0,0,169,0H70A27.62,27.62,0,0,0,42.33,27.62V47.19a55.64,55.64,0,0,1,23.83-6,55.41,55.41,0,0,1,29,8.91,9.52,9.52,0,0,0,10.22-.22,93.64,93.64,0,0,1,34.52-13.41,3.11,3.11,0,0,1,2.58.62,3,3,0,0,1,1.12,2.38c-.25,8.69-2.18,28.93-14,39.44"),g.setAttributeNS(null,"fill","white"),g.setAttributeNS(null,"d","M124.44,52.45A38.15,38.15,0,0,0,107,61.38s0,0,0,0l0,0a3.47,3.47,0,0,0-.26.37,3.3,3.3,0,0,0-.3.43,2.11,2.11,0,0,0-.12.48,2.68,2.68,0,0,0-.11.49,3.93,3.93,0,0,0,.06.48,2.1,2.1,0,0,0,.09.5,2.76,2.76,0,0,0,.25.44,3.38,3.38,0,0,0,.24.41l0,0,0,0A67.73,67.73,0,0,1,120,84.7l.12.26c.09.22.19.43.25.54a46.52,46.52,0,0,0,20.28,22.06,16.33,16.33,0,0,1-7.87,2.09,2.61,2.61,0,0,0-2.47,3.43,18.59,18.59,0,0,0,6.28,8.09,52.4,52.4,0,0,0-12.77,4.37,41.79,41.79,0,0,0-6.12,4.17A71.47,71.47,0,0,1,70.3,146.09a71.46,71.46,0,0,1-47.37-16.38,42.24,42.24,0,0,0-6.11-4.17A53,53,0,0,0,4,121.17a18.66,18.66,0,0,0,6.28-8.09,2.61,2.61,0,0,0-2.48-3.43A16.37,16.37,0,0,1,0,107.55a46.39,46.39,0,0,0,20.22-22c.1-.21.2-.42.29-.64l.14-.31A67.76,67.76,0,0,1,33.8,65.13l0,0,0,0a3.38,3.38,0,0,0,.24-.41,1.5,1.5,0,0,0,.34-.94,3.93,3.93,0,0,0,.06-.48,2.68,2.68,0,0,0-.11-.49,2.81,2.81,0,0,0-.12-.48,2.61,2.61,0,0,0-.31-.43,1.9,1.9,0,0,0-.26-.37l0,0,0,0a38.13,38.13,0,0,0-17.48-8.93,2.6,2.6,0,0,0-1,5.1,32,32,0,0,1,13,6.06A73.77,73.77,0,0,0,16.92,80.3C7,71.07,5.38,53.31,5.16,45.7a2.65,2.65,0,0,1,1-2.1,2.57,2.57,0,0,1,2.17-.54A76.8,76.8,0,0,1,37.34,54.83a7.72,7.72,0,0,0,8.59.18A45.38,45.38,0,0,1,70.3,47.19,45.32,45.32,0,0,1,94.67,55a7.72,7.72,0,0,0,8.6-.19,77,77,0,0,1,29.06-11.76,2.49,2.49,0,0,1,2.16.54,2.63,2.63,0,0,1,.95,2.09c-.21,7.62-1.83,25.38-11.75,34.61a73.77,73.77,0,0,0-11.22-16.69,32,32,0,0,1,13-6.06,2.59,2.59,0,0,0,2-1.72"),y.setAttributeNS(null,"fill","white"),y.setAttributeNS(null,"d","M11.469,10l7.08-7.08c0.406-0.406,0.406-1.064,0-1.469c-0.406-0.406-1.063-0.406-1.469,0L10,8.53l-7.081-7.08 c-0.406-0.406-1.064-0.406-1.469,0c-0.406,0.406-0.406,1.063,0,1.469L8.531,10L1.45,17.081c-0.406,0.406-0.406,1.064,0,1.469 c0.203,0.203,0.469,0.304,0.735,0.304c0.266,0,0.531-0.101,0.735-0.304L10,11.469l7.08,7.081c0.203,0.203,0.469,0.304,0.735,0.304 c0.267,0,0.532-0.101,0.735-0.304c0.406-0.406,0.406-1.064,0-1.469L11.469,10z"),m.appendChild(w),m.appendChild(w),f.appendChild(y),m.classList.add("open"),m.setAttribute(null,"viewBox","0 0 198 162.64"),f.classList.add("close"),f.setAttribute(null,"viewBox","0 0 20 20"),u.appendChild(m),u.appendChild(f),h.appendChild(u),e.querySelector("body").appendChild(p),e.querySelector("body").appendChild(h),h.onclick=function(){h.classList.toggle("active"),p.classList.toggle("active")},setTimeout((()=>{h.classList.add("loaded"),console.log("Chat Pimex init")}),500)}}})();